@model IEnumerable<MujeresEmpoderadas.Models.JefaDeFamilia>

@{
    ViewBag.Title = "BienesYServicios";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Bienes y Servicios</h2>
<h4>Aquí encontraras los bienes y servicios de las mujeres pertenecientes al programa.</h4>
<hr/>

<div id="map"></div>

@section Scripts {
    <script>

        function initMap() {

            var mapDiv = document.getElementById('map');
            var map = new google.maps.Map(mapDiv, {
                center: { lat: 20.6282129, lng: -103.6223692 },
                zoom: 8
            });

            var infowindow = new google.maps.InfoWindow({
                content: ''
            });

            var marcadores = [

            @foreach (var item in Model)
            {
                if (item.Negocio.Nombre != "")
                {
                    <text>
            {
                position: {
                    lat: @item.Negocio.Latitud,
                    lng: @item.Negocio.Longitud
                },
                    contenido: '<div class="mapaContenido">'+
                  '<h1>@item.Negocio.Nombre</h1>'+
                  '<p>@item.Negocio.CategoriaNegocio</p>' +
                  '<p>Dirección: @item.Negocio.Calle @item.Negocio.NoExterior, @item.Negocio.Colonia, @item.Negocio.Localidad</p>'+
                  '<p>Teléfono: @item.Negocio.Telefono </p>' +
                  '</div>'
            },
                    </text>
                }
            }

            ];

            for (var i = 0, j = marcadores.length; i < j; i++) {
                var contenido = marcadores[i].contenido;
                var marker = new google.maps.Marker({
                    position: new google.maps.LatLng(marcadores[i].position.lat, marcadores[i].position.lng),
                    map: map
                });
                (function (marker, contenido) {
                    google.maps.event.addListener(marker, 'click', function () {
                        infowindow.setContent(contenido);
                        infowindow.open(map, marker);
                    });
                })(marker, contenido);
            }
        }
    </script>
    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCviwCQrkPnevAr7hDqT4hTWb4i5u9jTDM&callback=initMap">
    </script>
}